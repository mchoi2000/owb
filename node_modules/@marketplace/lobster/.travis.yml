language: node_js
node_js:
- 4.2.1
env:
  global:
  - APP_PATH=${TRAVIS_BUILD_DIR}
  - APP_NAME="lobster"
  # Gemfury token
  - secure: Bp0jP3rgD0Mtt4eW1et58eK9idbALuOdKhVN/Cig/e0s4LME+PRdFjO0Y3zrE9QNHX7VChsckDWeIozvqiDvsTv8Kmuw8kRDZbIAdULLPtPDzLs0A/4pWP+T1+CbvOFjUBMWZVKjFHpQtnqJ0emGgar5O3Com3L+44x4G4cX2ds=
  # CODE_COVERAGE_API_KEY
  - secure: XFFjBsRhP4+VZVv6rfovzGG3YaNw7DOWxBoKLMbfIp8hH4H3fVXHfY33lVt2pHzPqm0L1L3QX45GPS7WBwS/cufI20BccL6LENf8DtM9S8wO81vHP34iSdCBoQRnCAZ4UHuH0FJ0x716OxCFlg4IsrQaP3Zx3D5+zeYbikZ7gNE=

before_script:
- npm install --unsafe-perm
script:
- npm test
deploy:
  provider: script
  skip_cleanup: true
  script: "./node_modules/.bin/publish_package.sh ${PWD} && gulp lobster"
  on:
    branch: master
