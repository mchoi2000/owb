{"version":3,"file":"levels.js","sources":["../src/node_modules/levels.js"],"sourcesContent":["\n// IMPORTS /////////////////////////////////////////////////////////////////////\n\nimport _                                    from 'lodash';\nimport * as defaults                        from 'defaults';\nimport text                                 from 'text';\nimport { BadOptionsError }                  from 'error';\n\n// LEVEL NUMBERS ///////////////////////////////////////////////////////////////\n\nexport const isNumberValid = n =>\n\tNumber.isInteger(parseFloat(n)) && _.inRange(n, 8);\n\n// NORMALIZATION & DEFAULTS ////////////////////////////////////////////////////\n\nconst normArr = (arr, opts) => {\n\tif (arr.length > 8)\n\t\tthrow new BadOptionsError(opts, text.tooManyLevels(arr.length));\n\n\treturn arr.map(val => {\n\t\tif (val && _.isString(val)) return val;\n\t\tif (_.isNumber(val) && isFinite(val)) return val.toString();\n\t\tif (_.isNull(val) || _.isUndefined(val)) return;\n\n\t\tthrow new BadOptionsError(opts, text.levelNotString(val));\n\t});\n};\n\nconst normObj = (obj, opts) => {\n\tconst lvlNums = _.values(obj);\n\n\tfor (const num of lvlNums) {\n\t\tif (!isNumberValid(num))\n\t\t\tthrow new BadOptionsError(opts, text.invalidLevelNum(num));\n\t}\n\n\tconst duplicates =\n\t\t_(obj).countBy().pick(lvl => lvl > 1).keys().value();\n\n\tif (duplicates.length)\n\t\tthrow new BadOptionsError(opts, text.duplicateLevelNums(duplicates));\n\n\treturn _.reduce(obj, (arr, i, name) => {\n\t\tarr[i] = name;\n\t\treturn arr;\n\t}, []);\n};\n\nexport const normalize = (opts) => {\n\n\tlet custom = opts.levels;\n\n\tif (!_.isUndefined(custom) && !_.isNull(custom) && !_.isObject(custom))\n\t\tthrow new BadOptionsError(opts, text.levelsNotObj(typeof custom));\n\n\tif (!custom)\n\t\treturn defaults.levels.slice();\n\n\tcustom = _.isArray(custom) ? normArr(custom, opts) : normObj(custom, opts);\n\n\tconst levels = defaults.levels.map((lvl, i) => custom[i] || lvl);\n\n\tconst duplicates =\n\t\t_(levels).countBy().pick(count => count > 1).keys().value();\n\n\tif (duplicates.length)\n\t\tthrow new BadOptionsError(opts, text.duplicateLevels(duplicates));\n\n\treturn levels;\n};\n"],"names":[],"mappings":"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"}